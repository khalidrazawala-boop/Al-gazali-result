<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AL GAZALI ONLINE GIRLS ACADEMY | OFFICIAL PORTAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu&family=Cinzel:wght@400;700;900&family=Great+Vibes&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root { --primary: #064e3b; --gold: #b45309; --light-gold: #fbbf24; }
        body { font-family: 'Poppins', sans-serif; background-color: #f8fafc; color: #1e293b; overflow-x: hidden; }
        .urdu { font-family: 'Noto Nastaliq Urdu', serif; direction: rtl; }
        
        /* Stylish Academy Name */
        .academy-title {
            font-family: 'Cinzel', serif;
            letter-spacing: 0.15em;
            background: linear-gradient(to right, #fde68a, #f59e0b, #fde68a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: 900;
        }

        .premium-border { 
            border: 20px solid transparent;
            border-image: url('https://www.transparenttextures.com/patterns/gold-dust.png') 30 stretch;
            background: white;
            box-shadow: 0 25px 60px rgba(0,0,0,0.15);
            position: relative;
        }
        .inner-frame { border: 1px solid var(--gold); padding: 40px; position: relative; }
        .inner-frame::before {
            content: '';
            position: absolute;
            top: 5px; left: 5px; right: 5px; bottom: 5px;
            border: 3px double var(--primary);
            pointer-events: none;
        }
        
        .watermark { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); 
            font-size: 6rem; opacity: 0.04; font-weight: 900; pointer-events: none; z-index: 0; 
            color: var(--primary); font-family: 'Cinzel', serif;
        }

        .header-gradient { 
            background: radial-gradient(circle at center, #065f46 0%, #022c22 100%); 
            border-bottom: 5px solid var(--gold);
        }

        .btn-gold { 
            background: linear-gradient(135deg, #d97706, #92400e); 
            color: white;
            box-shadow: 0 4px 15px rgba(180, 83, 9, 0.3);
        }

        .hidden { display: none; }
        
        @media print { 
            .no-print { display: none !important; } 
            .premium-border { border: 10px double var(--gold) !important; box-shadow: none; }
            .academy-title { -webkit-text-fill-color: #064e3b !important; text-shadow: none; }
        }
    </style>
</head>
<body>

    <!-- Stylish Header -->
    <header class="header-gradient text-white py-16 px-6 text-center no-print">
        <div class="max-w-5xl mx-auto">
            <h1 class="academy-title text-3xl md:text-5xl mb-4">AL GAZALI ONLINE GIRLS ACADEMY</h1>
            <div class="flex items-center justify-center gap-4 mb-6">
                <div class="h-[1px] w-20 bg-amber-500/50"></div>
                <span class="text-amber-400 text-xs tracking-[0.5em] font-bold uppercase">Excellence in Education</span>
                <div class="h-[1px] w-20 bg-amber-500/50"></div>
            </div>
            <p class="urdu text-3xl mt-4 text-white/90 drop-shadow-lg">ÿ™ÿπŸÑ€åŸÖ Ÿà ÿ™ÿ±ÿ®€åÿ™ ⁄©ÿß ÿß€å⁄© ŸÖÿ´ÿßŸÑ€å ÿßŸàÿ± ŸÖÿπ€åÿßÿ±€å ŸÖÿ±⁄©ÿ≤</p>
            
            <div class="mt-12 flex flex-wrap justify-center gap-6">
                <button onclick="goHome()" class="group relative px-8 py-3 overflow-hidden rounded-full transition-all">
                    <span class="absolute inset-0 bg-white/10 group-hover:bg-white/20"></span>
                    <span class="relative text-xs font-bold tracking-widest">PORTAL HOME</span>
                </button>
                <button onclick="showAdmin()" class="group relative px-8 py-3 overflow-hidden rounded-full transition-all">
                    <span class="absolute inset-0 bg-amber-600/20 group-hover:bg-amber-600/40 border border-amber-500/30"></span>
                    <span class="relative text-xs font-bold tracking-widest">ADMINISTRATOR</span>
                </button>
            </div>
        </div>
    </header>

    <div id="main-content" class="max-w-5xl mx-auto p-4 md:p-8 -mt-10">
        
        <!-- Selection View -->
        <div id="home-page" class="grid md:grid-cols-2 gap-10">
            <div class="bg-white p-12 rounded-[3rem] shadow-2xl border-t-8 border-emerald-900 transform hover:-translate-y-2 transition-all">
                <div class="text-5xl mb-6">üìú</div>
                <h2 class="text-3xl font-black text-gray-800 mb-4 uppercase italic">Official Result</h2>
                <p class="text-gray-400 mb-8">Download your verified academic marksheet.</p>
                <input id="rollRes" type="text" placeholder="Enter Roll Number" class="w-full p-5 bg-gray-50 border-2 border-gray-100 rounded-2xl mb-6 text-center font-bold text-xl focus:border-emerald-700 outline-none">
                <button onclick="fetchData('result')" class="w-full bg-emerald-900 text-white py-5 rounded-2xl font-bold text-lg shadow-lg hover:shadow-2xl transition-all">VIEW MARKSHEET</button>
            </div>

            <div class="bg-white p-12 rounded-[3rem] shadow-2xl border-t-8 border-amber-600 transform hover:-translate-y-2 transition-all">
                <div class="text-5xl mb-6">üéüÔ∏è</div>
                <h2 class="text-3xl font-black text-gray-800 mb-4 uppercase italic">Admit Card</h2>
                <p class="text-gray-400 mb-8">Generate entrance permit for examinations.</p>
                <input id="rollAdmit" type="text" placeholder="Enter Roll Number" class="w-full p-5 bg-gray-50 border-2 border-gray-100 rounded-2xl mb-6 text-center font-bold text-xl focus:border-amber-600 outline-none">
                <button onclick="fetchData('admit')" class="w-full btn-gold py-5 rounded-2xl font-bold text-lg shadow-lg">GENERATE CARD</button>
            </div>
        </div>

        <!-- Result/Marksheet Display -->
        <div id="result-page" class="hidden premium-border bg-white p-4">
            <div class="inner-frame">
                <div class="watermark text-center">AL GAZALI</div>
                
                <div class="text-center border-b-4 border-double border-emerald-900 pb-8 mb-10">
                    <h2 class="academy-title text-2xl md:text-4xl text-emerald-900 !-webkit-text-fill-color-inherit">AL GAZALI ONLINE GIRLS ACADEMY</h2>
                    <p class="text-[10px] tracking-[0.6em] font-bold text-amber-700 mt-4 uppercase">Certificate of Academic Achievement</p>
                    <p class="urdu text-2xl mt-4 font-bold text-emerald-800">ÿ≥ÿßŸÑÿßŸÜ€Å ÿ™ÿπŸÑ€åŸÖ€å ÿ±ŸæŸàÿ±Ÿπ ⁄©ÿßÿ±⁄à</p>
                </div>

                <div class="grid grid-cols-2 gap-8 text-sm mb-10 bg-emerald-50/30 p-8 rounded-3xl border border-emerald-100">
                    <div class="space-y-4">
                        <p><span class="text-gray-400 font-bold uppercase text-[9px] block">Student Name</span> <span id="resName" class="text-xl font-bold text-emerald-900"></span></p>
                        <p><span class="text-gray-400 font-bold uppercase text-[9px] block">Father/Guardian</span> <span id="resFather" class="font-bold"></span></p>
                    </div>
                    <div class="text-right space-y-4">
                        <p><span class="text-gray-400 font-bold uppercase text-[9px] block">Roll Number</span> <span id="resRoll" class="text-xl font-black tracking-widest text-emerald-900"></span></p>
                        <p><span class="text-gray-400 font-bold uppercase text-[9px] block">Class/Section</span> <span id="resClass" class="font-bold"></span></p>
                    </div>
                </div>

                <table class="w-full text-sm mb-12 border-separate border-spacing-y-1">
                    <thead>
                        <tr class="bg-emerald-900 text-white text-[10px] tracking-widest uppercase">
                            <th class="p-4 text-left rounded-l-lg">Subject Description</th>
                            <th class="p-4 text-center">Max Marks</th>
                            <th class="p-4 text-center rounded-r-lg">Marks Obtained</th>
                        </tr>
                    </thead>
                    <tbody id="resMarksBody" class="text-gray-700"></tbody>
                    <tfoot>
                        <tr class="bg-amber-600 text-white shadow-xl">
                            <td colspan="2" class="p-6 text-right font-black text-lg rounded-l-2xl uppercase italic">Grand Total Aggregate</td>
                            <td id="resTotal" class="p-6 text-center text-3xl font-black rounded-r-2xl bg-amber-700"></td>
                        </tr>
                    </tfoot>
                </table>

                <div class="mt-32 flex justify-between items-end px-10">
                    <div class="text-center w-40">
                        <div class="border-t-2 border-emerald-900 pt-3">
                            <p class="text-[9px] font-black text-emerald-900 uppercase">Exam Incharge</p>
                        </div>
                    </div>
                    <div class="flex justify-center">
                        <div class="w-24 h-24 border-4 border-double border-amber-200 rounded-full flex items-center justify-center text-[8px] text-amber-300 font-bold rotate-12">Verified Office Stamp</div>
                    </div>
                    <div class="text-center w-40">
                        <div class="border-t-2 border-emerald-900 pt-3">
                            <p class="text-[9px] font-black text-emerald-900 uppercase">Principal Signature</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="no-print p-8 bg-gray-50 flex gap-4 mt-6 rounded-3xl">
                <button onclick="window.print()" class="flex-1 bg-emerald-900 text-white py-5 rounded-2xl font-black shadow-xl">PRINT DOCUMENT</button>
                <button onclick="goHome()" class="px-10 bg-white border py-5 rounded-2xl text-gray-400 font-bold">CANCEL</button>
            </div>
        </div>

        <!-- Admin Portal -->
        <div id="admin-page" class="hidden bg-white p-12 rounded-[3.5rem] shadow-2xl border border-gray-100 mt-6">
            <h2 class="academy-title text-2xl text-center mb-10 !-webkit-text-fill-color-inherit text-emerald-900">ACADEMY RECORDS MANAGEMENT</h2>
            
            <div id="admin-login-sec" class="max-w-xs mx-auto text-center space-y-6">
                <input id="adminPass" type="password" placeholder="Passcode" class="w-full p-6 bg-gray-50 border-2 rounded-3xl text-center text-2xl focus:border-emerald-900 outline-none">
                <button onclick="adminLogin()" class="w-full bg-emerald-900 text-white py-5 rounded-3xl font-bold shadow-lg">AUTHORIZE ACCESS</button>
            </div>

            <div id="admin-fields" class="hidden space-y-8 animate-in fade-in duration-700">
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="col-span-2"><label class="text-[10px] font-bold text-emerald-900 uppercase ml-4">Full Student Name</label><input id="nName" class="w-full p-4 bg-gray-50 border rounded-2xl mt-1 focus:ring-2 ring-emerald-100"></div>
                    <div><label class="text-[10px] font-bold text-emerald-900 uppercase ml-4">Roll Number</label><input id="nRoll" class="w-full p-4 bg-gray-50 border rounded-2xl mt-1 focus:ring-2 ring-emerald-100"></div>
                    <div><label class="text-[10px] font-bold text-emerald-900 uppercase ml-4">Father Name</label><input id="nFather" class="w-full p-4 bg-gray-50 border rounded-2xl mt-1 focus:ring-2 ring-emerald-100"></div>
                    <div class="col-span-2"><label class="text-[10px] font-bold text-emerald-900 uppercase ml-4">Class/Grade</label><input id="nClass" class="w-full p-4 bg-gray-50 border rounded-2xl mt-1 focus:ring-2 ring-emerald-100"></div>
                </div>

                <div class="bg-amber-50/50 p-8 rounded-3xl border border-amber-100">
                    <h4 class="text-xs font-black text-amber-800 mb-6 uppercase tracking-widest">Enter Subjects & Marks</h4>
                    <div id="subjects-grid" class="grid md:grid-cols-2 gap-4">
                        <div class="flex gap-2"><input placeholder="Subject Name" class="s-name w-2/3 p-4 border rounded-2xl bg-white"><input placeholder="Marks" class="s-mark w-1/3 p-4 border rounded-2xl text-center font-bold"></div>
                        <div class="flex gap-2"><input placeholder="Subject Name" class="s-name w-2/3 p-4 border rounded-2xl bg-white"><input placeholder="Marks" class="s-mark w-1/3 p-4 border rounded-2xl text-center font-bold"></div>
                        <div class="flex gap-2"><input placeholder="Subject Name" class="s-name w-2/3 p-4 border rounded-2xl bg-white"><input placeholder="Marks" class="s-mark w-1/3 p-4 border rounded-2xl text-center font-bold"></div>
                        <div class="flex gap-2"><input placeholder="Subject Name" class="s-name w-2/3 p-4 border rounded-2xl bg-white"><input placeholder="Marks" class="s-mark w-1/3 p-4 border rounded-2xl text-center font-bold"></div>
                        <div class="flex gap-2"><input placeholder="Subject Name" class="s-name w-2/3 p-4 border rounded-2xl bg-white"><input placeholder="Marks" class="s-mark w-1/3 p-4 border rounded-2xl text-center font-bold"></div>
                        <div class="flex gap-2"><input placeholder="Subject Name" class="s-name w-2/3 p-4 border rounded-2xl bg-white"><input placeholder="Marks" class="s-mark w-1/3 p-4 border rounded-2xl text-center font-bold"></div>
                    </div>
                </div>

                <button id="saveBtn" onclick="saveData()" class="w-full bg-emerald-900 text-white py-6 rounded-[2.5rem] font-black text-xl shadow-2xl hover:bg-emerald-800 transition-all">PUBLISH OFFICIAL RECORD</button>
            </div>
            <button onclick="goHome()" class="w-full text-xs text-gray-400 mt-10 uppercase font-black tracking-widest">Return to Home</button>
        </div>
    </div>

    <script>
        let db, appId;

        async function startApp() {
            try {
                if (typeof __firebase_config === 'undefined') return;
                const config = JSON.parse(__firebase_config);
                if (!firebase.apps.length) firebase.initializeApp(config);
                db = firebase.firestore();
                appId = typeof __app_id !== 'undefined' ? __app_id : 'al-gazali-academy-v1';
                await firebase.auth().signInAnonymously();
            } catch(e) { console.error("Database Connection Issue", e); }
        }
        window.onload = startApp;

        function goHome() {
            document.querySelectorAll('#home-page, #result-page, #admin-page').forEach(e => e.classList.add('hidden'));
            document.getElementById('home-page').classList.remove('hidden');
        }

        function showAdmin() {
            document.querySelectorAll('#home-page, #result-page, #admin-page').forEach(e => e.classList.add('hidden'));
            document.getElementById('admin-page').classList.remove('hidden');
        }

        function adminLogin() {
            if(document.getElementById('adminPass').value === '1234') {
                document.getElementById('admin-login-sec').classList.add('hidden');
                document.getElementById('admin-fields').classList.remove('hidden');
            } else { alert("ACCESS DENIED: INCORRECT PASSCODE"); }
        }

        async function saveData() {
            if (!db) { await startApp(); if(!db) return alert("System connecting... Please try again."); }

            const roll = document.getElementById('nRoll').value.trim();
            const name = document.getElementById('nName').value.trim();
            if(!roll || !name) return alert("Error: Name and Roll Number are mandatory.");

            const subjects = [];
            document.querySelectorAll('.s-name').forEach((el, i) => {
                const mark = document.querySelectorAll('.s-mark')[i].value.trim();
                if(el.value.trim()) subjects.push({ name: el.value.trim(), marks: mark || "0" });
            });

            const btn = document.getElementById('saveBtn');
            btn.innerText = "SYNCHRONIZING..."; btn.disabled = true;

            try {
                const path = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('students').doc(roll);
                await path.set({
                    rollNo: roll, name: name,
                    father: document.getElementById('nFather').value.trim(),
                    class: document.getElementById('nClass').value.trim(),
                    subjects: subjects,
                    published: new Date().toLocaleDateString()
                });
                alert("SUCCESS: Official Record has been published.");
                location.reload();
            } catch(e) { alert("Publishing Error: " + e.message); }
            btn.innerText = "PUBLISH OFFICIAL RECORD"; btn.disabled = false;
        }

        async function fetchData(mode) {
            const rollInput = mode === 'result' ? 'rollRes' : 'rollAdmit';
            const roll = document.getElementById(rollInput).value.trim();
            if(!roll) return alert("Please enter Roll Number");

            try {
                const doc = await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('students').doc(roll).get();
                if(doc.exists) displayResult(doc.data());
                else alert("Data not found for this Roll Number.");
            } catch(e) { alert("Server is busy, try again in a moment."); }
        }

        function displayResult(data) {
            goHome();
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('result-page').classList.remove('hidden');

            document.getElementById('resName').innerText = data.name;
            document.getElementById('resFather').innerText = data.father || '-';
            document.getElementById('resRoll').innerText = data.rollNo;
            document.getElementById('resClass').innerText = data.class || '-';

            let rows = "", total = 0;
            data.subjects.forEach(s => {
                rows += `
                <tr class="bg-white hover:bg-emerald-50 transition-colors">
                    <td class="p-5 border-b border-gray-100 font-black text-gray-800 uppercase italic text-[12px]">${s.name}</td>
                    <td class="p-5 border-b border-gray-100 text-center text-gray-400 font-bold">100</td>
                    <td class="p-5 border-b border-gray-100 text-center font-black text-emerald-900 bg-emerald-50/30 text-lg">${s.marks}</td>
                </tr>`;
                total += Number(s.marks);
            });
            document.getElementById('resMarksBody').innerHTML = rows;
            document.getElementById('resTotal').innerText = total;
        }
    </script>
</body>
</html>

